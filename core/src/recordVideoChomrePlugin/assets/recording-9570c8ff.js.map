{"version":3,"file":"recording-9570c8ff.js","sources":["../../node_modules/.pnpm/fix-webm-duration@1.0.5/node_modules/fix-webm-duration/fix-webm-duration.js","../../src/lib/recording.ts"],"sourcesContent":["(function (name, definition) {\r\n    if (typeof define === 'function' && define.amd) { // RequireJS / AMD\r\n        define(definition);\r\n    } else if (typeof module !== 'undefined' && module.exports) { // CommonJS / Node.js\r\n        module.exports = definition();\r\n    } else { // Direct include\r\n        window.ysFixWebmDuration = definition();\r\n    }\r\n})('fix-webm-duration', function () {\r\n    /*\r\n     * This is the list of possible WEBM file sections by their IDs.\r\n     * Possible types: Container, Binary, Uint, Int, String, Float, Date\r\n     */\r\n    var sections = {\r\n        0xa45dfa3: { name: 'EBML', type: 'Container' },\r\n        0x286: { name: 'EBMLVersion', type: 'Uint' },\r\n        0x2f7: { name: 'EBMLReadVersion', type: 'Uint' },\r\n        0x2f2: { name: 'EBMLMaxIDLength', type: 'Uint' },\r\n        0x2f3: { name: 'EBMLMaxSizeLength', type: 'Uint' },\r\n        0x282: { name: 'DocType', type: 'String' },\r\n        0x287: { name: 'DocTypeVersion', type: 'Uint' },\r\n        0x285: { name: 'DocTypeReadVersion', type: 'Uint' },\r\n        0x6c: { name: 'Void', type: 'Binary' },\r\n        0x3f: { name: 'CRC-32', type: 'Binary' },\r\n        0xb538667: { name: 'SignatureSlot', type: 'Container' },\r\n        0x3e8a: { name: 'SignatureAlgo', type: 'Uint' },\r\n        0x3e9a: { name: 'SignatureHash', type: 'Uint' },\r\n        0x3ea5: { name: 'SignaturePublicKey', type: 'Binary' },\r\n        0x3eb5: { name: 'Signature', type: 'Binary' },\r\n        0x3e5b: { name: 'SignatureElements', type: 'Container' },\r\n        0x3e7b: { name: 'SignatureElementList', type: 'Container' },\r\n        0x2532: { name: 'SignedElement', type: 'Binary' },\r\n        0x8538067: { name: 'Segment', type: 'Container' },\r\n        0x14d9b74: { name: 'SeekHead', type: 'Container' },\r\n        0xdbb: { name: 'Seek', type: 'Container' },\r\n        0x13ab: { name: 'SeekID', type: 'Binary' },\r\n        0x13ac: { name: 'SeekPosition', type: 'Uint' },\r\n        0x549a966: { name: 'Info', type: 'Container' },\r\n        0x33a4: { name: 'SegmentUID', type: 'Binary' },\r\n        0x3384: { name: 'SegmentFilename', type: 'String' },\r\n        0x1cb923: { name: 'PrevUID', type: 'Binary' },\r\n        0x1c83ab: { name: 'PrevFilename', type: 'String' },\r\n        0x1eb923: { name: 'NextUID', type: 'Binary' },\r\n        0x1e83bb: { name: 'NextFilename', type: 'String' },\r\n        0x444: { name: 'SegmentFamily', type: 'Binary' },\r\n        0x2924: { name: 'ChapterTranslate', type: 'Container' },\r\n        0x29fc: { name: 'ChapterTranslateEditionUID', type: 'Uint' },\r\n        0x29bf: { name: 'ChapterTranslateCodec', type: 'Uint' },\r\n        0x29a5: { name: 'ChapterTranslateID', type: 'Binary' },\r\n        0xad7b1: { name: 'TimecodeScale', type: 'Uint' },\r\n        0x489: { name: 'Duration', type: 'Float' },\r\n        0x461: { name: 'DateUTC', type: 'Date' },\r\n        0x3ba9: { name: 'Title', type: 'String' },\r\n        0xd80: { name: 'MuxingApp', type: 'String' },\r\n        0x1741: { name: 'WritingApp', type: 'String' },\r\n        // 0xf43b675: { name: 'Cluster', type: 'Container' },\r\n        0x67: { name: 'Timecode', type: 'Uint' },\r\n        0x1854: { name: 'SilentTracks', type: 'Container' },\r\n        0x18d7: { name: 'SilentTrackNumber', type: 'Uint' },\r\n        0x27: { name: 'Position', type: 'Uint' },\r\n        0x2b: { name: 'PrevSize', type: 'Uint' },\r\n        0x23: { name: 'SimpleBlock', type: 'Binary' },\r\n        0x20: { name: 'BlockGroup', type: 'Container' },\r\n        0x21: { name: 'Block', type: 'Binary' },\r\n        0x22: { name: 'BlockVirtual', type: 'Binary' },\r\n        0x35a1: { name: 'BlockAdditions', type: 'Container' },\r\n        0x26: { name: 'BlockMore', type: 'Container' },\r\n        0x6e: { name: 'BlockAddID', type: 'Uint' },\r\n        0x25: { name: 'BlockAdditional', type: 'Binary' },\r\n        0x1b: { name: 'BlockDuration', type: 'Uint' },\r\n        0x7a: { name: 'ReferencePriority', type: 'Uint' },\r\n        0x7b: { name: 'ReferenceBlock', type: 'Int' },\r\n        0x7d: { name: 'ReferenceVirtual', type: 'Int' },\r\n        0x24: { name: 'CodecState', type: 'Binary' },\r\n        0x35a2: { name: 'DiscardPadding', type: 'Int' },\r\n        0xe: { name: 'Slices', type: 'Container' },\r\n        0x68: { name: 'TimeSlice', type: 'Container' },\r\n        0x4c: { name: 'LaceNumber', type: 'Uint' },\r\n        0x4d: { name: 'FrameNumber', type: 'Uint' },\r\n        0x4b: { name: 'BlockAdditionID', type: 'Uint' },\r\n        0x4e: { name: 'Delay', type: 'Uint' },\r\n        0x4f: { name: 'SliceDuration', type: 'Uint' },\r\n        0x48: { name: 'ReferenceFrame', type: 'Container' },\r\n        0x49: { name: 'ReferenceOffset', type: 'Uint' },\r\n        0x4a: { name: 'ReferenceTimeCode', type: 'Uint' },\r\n        0x2f: { name: 'EncryptedBlock', type: 'Binary' },\r\n        0x654ae6b: { name: 'Tracks', type: 'Container' },\r\n        0x2e: { name: 'TrackEntry', type: 'Container' },\r\n        0x57: { name: 'TrackNumber', type: 'Uint' },\r\n        0x33c5: { name: 'TrackUID', type: 'Uint' },\r\n        0x3: { name: 'TrackType', type: 'Uint' },\r\n        0x39: { name: 'FlagEnabled', type: 'Uint' },\r\n        0x8: { name: 'FlagDefault', type: 'Uint' },\r\n        0x15aa: { name: 'FlagForced', type: 'Uint' },\r\n        0x1c: { name: 'FlagLacing', type: 'Uint' },\r\n        0x2de7: { name: 'MinCache', type: 'Uint' },\r\n        0x2df8: { name: 'MaxCache', type: 'Uint' },\r\n        0x3e383: { name: 'DefaultDuration', type: 'Uint' },\r\n        0x34e7a: { name: 'DefaultDecodedFieldDuration', type: 'Uint' },\r\n        0x3314f: { name: 'TrackTimecodeScale', type: 'Float' },\r\n        0x137f: { name: 'TrackOffset', type: 'Int' },\r\n        0x15ee: { name: 'MaxBlockAdditionID', type: 'Uint' },\r\n        0x136e: { name: 'Name', type: 'String' },\r\n        0x2b59c: { name: 'Language', type: 'String' },\r\n        0x6: { name: 'CodecID', type: 'String' },\r\n        0x23a2: { name: 'CodecPrivate', type: 'Binary' },\r\n        0x58688: { name: 'CodecName', type: 'String' },\r\n        0x3446: { name: 'AttachmentLink', type: 'Uint' },\r\n        0x1a9697: { name: 'CodecSettings', type: 'String' },\r\n        0x1b4040: { name: 'CodecInfoURL', type: 'String' },\r\n        0x6b240: { name: 'CodecDownloadURL', type: 'String' },\r\n        0x2a: { name: 'CodecDecodeAll', type: 'Uint' },\r\n        0x2fab: { name: 'TrackOverlay', type: 'Uint' },\r\n        0x16aa: { name: 'CodecDelay', type: 'Uint' },\r\n        0x16bb: { name: 'SeekPreRoll', type: 'Uint' },\r\n        0x2624: { name: 'TrackTranslate', type: 'Container' },\r\n        0x26fc: { name: 'TrackTranslateEditionUID', type: 'Uint' },\r\n        0x26bf: { name: 'TrackTranslateCodec', type: 'Uint' },\r\n        0x26a5: { name: 'TrackTranslateTrackID', type: 'Binary' },\r\n        0x60: { name: 'Video', type: 'Container' },\r\n        0x1a: { name: 'FlagInterlaced', type: 'Uint' },\r\n        0x13b8: { name: 'StereoMode', type: 'Uint' },\r\n        0x13c0: { name: 'AlphaMode', type: 'Uint' },\r\n        0x13b9: { name: 'OldStereoMode', type: 'Uint' },\r\n        0x30: { name: 'PixelWidth', type: 'Uint' },\r\n        0x3a: { name: 'PixelHeight', type: 'Uint' },\r\n        0x14aa: { name: 'PixelCropBottom', type: 'Uint' },\r\n        0x14bb: { name: 'PixelCropTop', type: 'Uint' },\r\n        0x14cc: { name: 'PixelCropLeft', type: 'Uint' },\r\n        0x14dd: { name: 'PixelCropRight', type: 'Uint' },\r\n        0x14b0: { name: 'DisplayWidth', type: 'Uint' },\r\n        0x14ba: { name: 'DisplayHeight', type: 'Uint' },\r\n        0x14b2: { name: 'DisplayUnit', type: 'Uint' },\r\n        0x14b3: { name: 'AspectRatioType', type: 'Uint' },\r\n        0xeb524: { name: 'ColourSpace', type: 'Binary' },\r\n        0xfb523: { name: 'GammaValue', type: 'Float' },\r\n        0x383e3: { name: 'FrameRate', type: 'Float' },\r\n        0x61: { name: 'Audio', type: 'Container' },\r\n        0x35: { name: 'SamplingFrequency', type: 'Float' },\r\n        0x38b5: { name: 'OutputSamplingFrequency', type: 'Float' },\r\n        0x1f: { name: 'Channels', type: 'Uint' },\r\n        0x3d7b: { name: 'ChannelPositions', type: 'Binary' },\r\n        0x2264: { name: 'BitDepth', type: 'Uint' },\r\n        0x62: { name: 'TrackOperation', type: 'Container' },\r\n        0x63: { name: 'TrackCombinePlanes', type: 'Container' },\r\n        0x64: { name: 'TrackPlane', type: 'Container' },\r\n        0x65: { name: 'TrackPlaneUID', type: 'Uint' },\r\n        0x66: { name: 'TrackPlaneType', type: 'Uint' },\r\n        0x69: { name: 'TrackJoinBlocks', type: 'Container' },\r\n        0x6d: { name: 'TrackJoinUID', type: 'Uint' },\r\n        0x40: { name: 'TrickTrackUID', type: 'Uint' },\r\n        0x41: { name: 'TrickTrackSegmentUID', type: 'Binary' },\r\n        0x46: { name: 'TrickTrackFlag', type: 'Uint' },\r\n        0x47: { name: 'TrickMasterTrackUID', type: 'Uint' },\r\n        0x44: { name: 'TrickMasterTrackSegmentUID', type: 'Binary' },\r\n        0x2d80: { name: 'ContentEncodings', type: 'Container' },\r\n        0x2240: { name: 'ContentEncoding', type: 'Container' },\r\n        0x1031: { name: 'ContentEncodingOrder', type: 'Uint' },\r\n        0x1032: { name: 'ContentEncodingScope', type: 'Uint' },\r\n        0x1033: { name: 'ContentEncodingType', type: 'Uint' },\r\n        0x1034: { name: 'ContentCompression', type: 'Container' },\r\n        0x254: { name: 'ContentCompAlgo', type: 'Uint' },\r\n        0x255: { name: 'ContentCompSettings', type: 'Binary' },\r\n        0x1035: { name: 'ContentEncryption', type: 'Container' },\r\n        0x7e1: { name: 'ContentEncAlgo', type: 'Uint' },\r\n        0x7e2: { name: 'ContentEncKeyID', type: 'Binary' },\r\n        0x7e3: { name: 'ContentSignature', type: 'Binary' },\r\n        0x7e4: { name: 'ContentSigKeyID', type: 'Binary' },\r\n        0x7e5: { name: 'ContentSigAlgo', type: 'Uint' },\r\n        0x7e6: { name: 'ContentSigHashAlgo', type: 'Uint' },\r\n        0xc53bb6b: { name: 'Cues', type: 'Container' },\r\n        0x3b: { name: 'CuePoint', type: 'Container' },\r\n        0x33: { name: 'CueTime', type: 'Uint' },\r\n        0x37: { name: 'CueTrackPositions', type: 'Container' },\r\n        0x77: { name: 'CueTrack', type: 'Uint' },\r\n        0x71: { name: 'CueClusterPosition', type: 'Uint' },\r\n        0x70: { name: 'CueRelativePosition', type: 'Uint' },\r\n        0x32: { name: 'CueDuration', type: 'Uint' },\r\n        0x1378: { name: 'CueBlockNumber', type: 'Uint' },\r\n        0x6a: { name: 'CueCodecState', type: 'Uint' },\r\n        0x5b: { name: 'CueReference', type: 'Container' },\r\n        0x16: { name: 'CueRefTime', type: 'Uint' },\r\n        0x17: { name: 'CueRefCluster', type: 'Uint' },\r\n        0x135f: { name: 'CueRefNumber', type: 'Uint' },\r\n        0x6b: { name: 'CueRefCodecState', type: 'Uint' },\r\n        0x941a469: { name: 'Attachments', type: 'Container' },\r\n        0x21a7: { name: 'AttachedFile', type: 'Container' },\r\n        0x67e: { name: 'FileDescription', type: 'String' },\r\n        0x66e: { name: 'FileName', type: 'String' },\r\n        0x660: { name: 'FileMimeType', type: 'String' },\r\n        0x65c: { name: 'FileData', type: 'Binary' },\r\n        0x6ae: { name: 'FileUID', type: 'Uint' },\r\n        0x675: { name: 'FileReferral', type: 'Binary' },\r\n        0x661: { name: 'FileUsedStartTime', type: 'Uint' },\r\n        0x662: { name: 'FileUsedEndTime', type: 'Uint' },\r\n        0x43a770: { name: 'Chapters', type: 'Container' },\r\n        0x5b9: { name: 'EditionEntry', type: 'Container' },\r\n        0x5bc: { name: 'EditionUID', type: 'Uint' },\r\n        0x5bd: { name: 'EditionFlagHidden', type: 'Uint' },\r\n        0x5db: { name: 'EditionFlagDefault', type: 'Uint' },\r\n        0x5dd: { name: 'EditionFlagOrdered', type: 'Uint' },\r\n        0x36: { name: 'ChapterAtom', type: 'Container' },\r\n        0x33c4: { name: 'ChapterUID', type: 'Uint' },\r\n        0x1654: { name: 'ChapterStringUID', type: 'String' },\r\n        0x11: { name: 'ChapterTimeStart', type: 'Uint' },\r\n        0x12: { name: 'ChapterTimeEnd', type: 'Uint' },\r\n        0x18: { name: 'ChapterFlagHidden', type: 'Uint' },\r\n        0x598: { name: 'ChapterFlagEnabled', type: 'Uint' },\r\n        0x2e67: { name: 'ChapterSegmentUID', type: 'Binary' },\r\n        0x2ebc: { name: 'ChapterSegmentEditionUID', type: 'Uint' },\r\n        0x23c3: { name: 'ChapterPhysicalEquiv', type: 'Uint' },\r\n        0xf: { name: 'ChapterTrack', type: 'Container' },\r\n        0x9: { name: 'ChapterTrackNumber', type: 'Uint' },\r\n        0x0: { name: 'ChapterDisplay', type: 'Container' },\r\n        0x5: { name: 'ChapString', type: 'String' },\r\n        0x37c: { name: 'ChapLanguage', type: 'String' },\r\n        0x37e: { name: 'ChapCountry', type: 'String' },\r\n        0x2944: { name: 'ChapProcess', type: 'Container' },\r\n        0x2955: { name: 'ChapProcessCodecID', type: 'Uint' },\r\n        0x50d: { name: 'ChapProcessPrivate', type: 'Binary' },\r\n        0x2911: { name: 'ChapProcessCommand', type: 'Container' },\r\n        0x2922: { name: 'ChapProcessTime', type: 'Uint' },\r\n        0x2933: { name: 'ChapProcessData', type: 'Binary' },\r\n        0x254c367: { name: 'Tags', type: 'Container' },\r\n        0x3373: { name: 'Tag', type: 'Container' },\r\n        0x23c0: { name: 'Targets', type: 'Container' },\r\n        0x28ca: { name: 'TargetTypeValue', type: 'Uint' },\r\n        0x23ca: { name: 'TargetType', type: 'String' },\r\n        0x23c5: { name: 'TagTrackUID', type: 'Uint' },\r\n        0x23c9: { name: 'TagEditionUID', type: 'Uint' },\r\n        0x23c4: { name: 'TagChapterUID', type: 'Uint' },\r\n        0x23c6: { name: 'TagAttachmentUID', type: 'Uint' },\r\n        0x27c8: { name: 'SimpleTag', type: 'Container' },\r\n        0x5a3: { name: 'TagName', type: 'String' },\r\n        0x47a: { name: 'TagLanguage', type: 'String' },\r\n        0x484: { name: 'TagDefault', type: 'Uint' },\r\n        0x487: { name: 'TagString', type: 'String' },\r\n        0x485: { name: 'TagBinary', type: 'Binary' }\r\n    };\r\n\r\n    function doInherit(newClass, baseClass) {\r\n        newClass.prototype = Object.create(baseClass.prototype);\r\n        newClass.prototype.constructor = newClass;\r\n    }\r\n\r\n    function WebmBase(name, type) {\r\n        this.name = name || 'Unknown';\r\n        this.type = type || 'Unknown';\r\n    }\r\n    WebmBase.prototype.updateBySource = function() { };\r\n    WebmBase.prototype.setSource = function(source) {\r\n        this.source = source;\r\n        this.updateBySource();\r\n    };\r\n    WebmBase.prototype.updateByData = function() { };\r\n    WebmBase.prototype.setData = function(data) {\r\n        this.data = data;\r\n        this.updateByData();\r\n    };\r\n\r\n    function WebmUint(name, type) {\r\n        WebmBase.call(this, name, type || 'Uint');\r\n    }\r\n    doInherit(WebmUint, WebmBase);\r\n    function padHex(hex) {\r\n        return hex.length % 2 === 1 ? '0' + hex : hex;\r\n    }\r\n    WebmUint.prototype.updateBySource = function() {\r\n        // use hex representation of a number instead of number value\r\n        this.data = '';\r\n        for (var i = 0; i < this.source.length; i++) {\r\n            var hex = this.source[i].toString(16);\r\n            this.data += padHex(hex);\r\n        }\r\n    };\r\n    WebmUint.prototype.updateByData = function() {\r\n        var length = this.data.length / 2;\r\n        this.source = new Uint8Array(length);\r\n        for (var i = 0; i < length; i++) {\r\n            var hex = this.data.substr(i * 2, 2);\r\n            this.source[i] = parseInt(hex, 16);\r\n        }\r\n    };\r\n    WebmUint.prototype.getValue = function() {\r\n        return parseInt(this.data, 16);\r\n    };\r\n    WebmUint.prototype.setValue = function(value) {\r\n        this.setData(padHex(value.toString(16)));\r\n    };\r\n\r\n    function WebmFloat(name, type) {\r\n        WebmBase.call(this, name, type || 'Float');\r\n    }\r\n    doInherit(WebmFloat, WebmBase);\r\n    WebmFloat.prototype.getFloatArrayType = function() {\r\n        return this.source && this.source.length === 4 ? Float32Array : Float64Array;\r\n    };\r\n    WebmFloat.prototype.updateBySource = function() {\r\n        var byteArray = this.source.reverse();\r\n        var floatArrayType = this.getFloatArrayType();\r\n        var floatArray = new floatArrayType(byteArray.buffer);\r\n        this.data = floatArray[0];\r\n    };\r\n    WebmFloat.prototype.updateByData = function() {\r\n        var floatArrayType = this.getFloatArrayType();\r\n        var floatArray = new floatArrayType([ this.data ]);\r\n        var byteArray = new Uint8Array(floatArray.buffer);\r\n        this.source = byteArray.reverse();\r\n    };\r\n    WebmFloat.prototype.getValue = function() {\r\n        return this.data;\r\n    };\r\n    WebmFloat.prototype.setValue = function(value) {\r\n        this.setData(value);\r\n    };\r\n\r\n    function WebmContainer(name, type) {\r\n        WebmBase.call(this, name, type || 'Container');\r\n    }\r\n    doInherit(WebmContainer, WebmBase);\r\n    WebmContainer.prototype.readByte = function() {\r\n        return this.source[this.offset++];\r\n    };\r\n    WebmContainer.prototype.readUint = function() {\r\n        var firstByte = this.readByte();\r\n        var bytes = 8 - firstByte.toString(2).length;\r\n        var value = firstByte - (1 << (7 - bytes));\r\n        for (var i = 0; i < bytes; i++) {\r\n            // don't use bit operators to support x86\r\n            value *= 256;\r\n            value += this.readByte();\r\n        }\r\n        return value;\r\n    };\r\n    WebmContainer.prototype.updateBySource = function() {\r\n        this.data = [];\r\n        for (this.offset = 0; this.offset < this.source.length; this.offset = end) {\r\n            var id = this.readUint();\r\n            var len = this.readUint();\r\n            var end = Math.min(this.offset + len, this.source.length);\r\n            var data = this.source.slice(this.offset, end);\r\n\r\n            var info = sections[id] || { name: 'Unknown', type: 'Unknown' };\r\n            var ctr = WebmBase;\r\n            switch (info.type) {\r\n                case 'Container':\r\n                    ctr = WebmContainer;\r\n                    break;\r\n                case 'Uint':\r\n                    ctr = WebmUint;\r\n                    break;\r\n                case 'Float':\r\n                    ctr = WebmFloat;\r\n                    break;\r\n            }\r\n            var section = new ctr(info.name, info.type);\r\n            section.setSource(data);\r\n            this.data.push({\r\n                id: id,\r\n                idHex: id.toString(16),\r\n                data: section\r\n            });\r\n        }\r\n    };\r\n    WebmContainer.prototype.writeUint = function(x, draft) {\r\n        for (var bytes = 1, flag = 0x80; x >= flag && bytes < 8; bytes++, flag *= 0x80) { }\r\n\r\n        if (!draft) {\r\n            var value = flag + x;\r\n            for (var i = bytes - 1; i >= 0; i--) {\r\n                // don't use bit operators to support x86\r\n                var c = value % 256;\r\n                this.source[this.offset + i] = c;\r\n                value = (value - c) / 256;\r\n            }\r\n        }\r\n\r\n        this.offset += bytes;\r\n    };\r\n    WebmContainer.prototype.writeSections = function(draft) {\r\n        this.offset = 0;\r\n        for (var i = 0; i < this.data.length; i++) {\r\n            var section = this.data[i],\r\n                content = section.data.source,\r\n                contentLength = content.length;\r\n            this.writeUint(section.id, draft);\r\n            this.writeUint(contentLength, draft);\r\n            if (!draft) {\r\n                this.source.set(content, this.offset);\r\n            }\r\n            this.offset += contentLength;\r\n        }\r\n        return this.offset;\r\n    };\r\n    WebmContainer.prototype.updateByData = function() {\r\n        // run without accessing this.source to determine total length - need to know it to create Uint8Array\r\n        var length = this.writeSections('draft');\r\n        this.source = new Uint8Array(length);\r\n        // now really write data\r\n        this.writeSections();\r\n    };\r\n    WebmContainer.prototype.getSectionById = function(id) {\r\n        for (var i = 0; i < this.data.length; i++) {\r\n            var section = this.data[i];\r\n            if (section.id === id) {\r\n                return section.data;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n\r\n    function WebmFile(source) {\r\n        WebmContainer.call(this, 'File', 'File');\r\n        this.setSource(source);\r\n    }\r\n    doInherit(WebmFile, WebmContainer);\r\n    WebmFile.prototype.fixDuration = function(duration, options) {\r\n        var logger = options && options.logger;\r\n        if (logger === undefined) {\r\n            logger = function(message) {\r\n                console.log(message);\r\n            };\r\n        } else if (!logger) {\r\n            logger = function() { };\r\n        }\r\n\r\n        var segmentSection = this.getSectionById(0x8538067);\r\n        if (!segmentSection) {\r\n            logger('[fix-webm-duration] Segment section is missing');\r\n            return false;\r\n        }\r\n\r\n        var infoSection = segmentSection.getSectionById(0x549a966);\r\n        if (!infoSection) {\r\n            logger('[fix-webm-duration] Info section is missing');\r\n            return false;\r\n        }\r\n\r\n        var timeScaleSection = infoSection.getSectionById(0xad7b1);\r\n        if (!timeScaleSection) {\r\n            logger('[fix-webm-duration] TimecodeScale section is missing');\r\n            return false;\r\n        }\r\n\r\n        var durationSection = infoSection.getSectionById(0x489);\r\n        if (durationSection) {\r\n            if (durationSection.getValue() <= 0) {\r\n                logger('[fix-webm-duration] Duration section is present, but the value is empty');\r\n                durationSection.setValue(duration);\r\n            } else {\r\n                logger('[fix-webm-duration] Duration section is present');\r\n                return false;\r\n            }\r\n        } else {\r\n            logger('[fix-webm-duration] Duration section is missing');\r\n            // append Duration section\r\n            durationSection = new WebmFloat('Duration', 'Float');\r\n            durationSection.setValue(duration);\r\n            infoSection.data.push({\r\n                id: 0x489,\r\n                data: durationSection\r\n            });\r\n        }\r\n\r\n        // set default time scale to 1 millisecond (1000000 nanoseconds)\r\n        timeScaleSection.setValue(1000000);\r\n        infoSection.updateByData();\r\n        segmentSection.updateByData();\r\n        this.updateByData();\r\n\r\n        return true;\r\n    };\r\n    WebmFile.prototype.toBlob = function(mimeType) {\r\n        return new Blob([ this.source.buffer ], { type: mimeType || 'video/webm' });\r\n    };\r\n\r\n    function fixWebmDuration(blob, duration, callback, options) {\r\n        // The callback may be omitted - then the third argument is options\r\n        if (typeof callback === \"object\") {\r\n            options = callback;\r\n            callback = undefined;\r\n        }\r\n\r\n        if (!callback) {\r\n            return new Promise(function(resolve) {\r\n                fixWebmDuration(blob, duration, resolve, options);\r\n            });\r\n        }\r\n\r\n        try {\r\n            var reader = new FileReader();\r\n            reader.onloadend = function() {\r\n                try {\r\n                    var file = new WebmFile(new Uint8Array(reader.result));\r\n                    if (file.fixDuration(duration, options)) {\r\n                        blob = file.toBlob(blob.type);\r\n                    }\r\n                } catch (ex) {\r\n                    // ignore\r\n                }\r\n                callback(blob);\r\n            };\r\n            reader.readAsArrayBuffer(blob);\r\n        } catch (ex) {\r\n            callback(blob);\r\n        }\r\n    }\r\n\r\n    // Support AMD import default\r\n    fixWebmDuration.default = fixWebmDuration;\r\n\r\n    return fixWebmDuration;\r\n});\r\n","import fixWebmDuration from 'fix-webm-duration'\nimport { defaultRecordingMode, tabCaptureModes } from '~/constants'\nimport { RecordingOptions } from '~/types'\n\nconst recorderMimeType = 'video/webm'\nconst frameRate = 30\nconst bitRate = 8 * 1024 * 1024\nconst devicePixelRatio = window.devicePixelRatio || 1\n\nclass Recorder {\n  private recorder: MediaRecorder | undefined\n  private data: Blob[] = []\n  private startTime: number\n  private media: MediaStream | undefined\n  private drawTimerId: ReturnType<typeof setTimeout> | null\n\n  constructor() {\n    this.recorder = undefined\n    this.data = []\n    this.startTime = 0\n    this.media = undefined\n    this.drawTimerId = null\n  }\n\n  private getChromeMediaSource(\n    recordingMode: RecordingOptions['recordingMode']\n  ) {\n    return tabCaptureModes.includes(recordingMode) ? 'tab' : 'desktop'\n  }\n\n  private createAreaRecorderMediaStream(area: RecordingOptions['area']) {\n    const canvas = document.createElement('canvas')\n    canvas.width = area.width\n    canvas.height = area.height\n\n    const ctx = canvas.getContext('2d')\n    if (!ctx) throw new Error('Could not get canvas context.')\n\n    ctx.imageSmoothingEnabled = true\n    ctx.imageSmoothingQuality = 'high'\n\n    const video = document.createElement('video')\n    video.srcObject = this.media as MediaStream\n    video.autoplay = true\n\n    const drawFrame = () => {\n      ctx.drawImage(\n        video,\n        area.x * devicePixelRatio,\n        area.y * devicePixelRatio,\n        area.width * devicePixelRatio - 2, // workaround for black line on the right side\n        area.height * devicePixelRatio - 1,\n        0,\n        0,\n        area.width,\n        area.height\n      )\n      this.drawTimerId = setTimeout(drawFrame, 1000 / frameRate)\n    }\n\n    video.addEventListener('play', () => {\n      drawFrame()\n    })\n\n    return canvas.captureStream(frameRate)\n  }\n\n  public async start(\n    {\n      streamId,\n      width,\n      height,\n      audio,\n      recordingMode = defaultRecordingMode,\n      area,\n    }: RecordingOptions,\n    callback?: (url: string) => void\n  ) {\n    if (this.recorder?.state === 'recording') {\n      throw new Error('Called startRecording while recording is in progress.')\n    }\n\n    const chromeMediaSource = this.getChromeMediaSource(recordingMode)\n    const videoConstraints: MediaTrackConstraints = {\n      // @ts-ignore\n      mandatory: {\n        chromeMediaSource,\n        chromeMediaSourceId: streamId,\n        minFrameRate: frameRate,\n        ...(width && {\n          minWidth: width * devicePixelRatio,\n          maxWidth: width * devicePixelRatio,\n        }),\n        ...(height && {\n          minHeight: height * devicePixelRatio,\n          maxHeight: height * devicePixelRatio,\n        }),\n      },\n    }\n\n    const mediaStreamConstraints: MediaStreamConstraints = {\n      audio: audio\n        ? {\n            // @ts-ignore\n            mandatory: {\n              chromeMediaSource,\n              chromeMediaSourceId: streamId,\n            },\n          }\n        : false,\n      video: videoConstraints,\n    }\n\n    this.media = await navigator.mediaDevices.getUserMedia(\n      mediaStreamConstraints\n    )\n\n    if (audio) {\n      const audioContext = new AudioContext()\n      const audioSource = audioContext.createMediaStreamSource(this.media)\n      audioSource.connect(audioContext.destination)\n    }\n\n    let recorderMedia = this.media\n    if (recordingMode === 'area') {\n      recorderMedia = this.createAreaRecorderMediaStream(area)\n      const audioTracks = this.media.getAudioTracks()\n      if (audioTracks.length > 0) {\n        recorderMedia.addTrack(audioTracks[0])\n      }\n    }\n\n    this.recorder = new MediaRecorder(recorderMedia, {\n      mimeType: recorderMimeType,\n      videoBitsPerSecond: bitRate,\n    })\n\n    this.recorder.ondataavailable = (event) => {\n      this.data.push(event.data)\n    }\n    this.recorder.onstop = async () => {\n      const duration = Date.now() - this.startTime\n      const blob = new Blob(this.data, { type: recorderMimeType })\n      const fixedBlob = await fixWebmDuration(blob, duration, { logger: false })\n\n      const url = URL.createObjectURL(fixedBlob)\n      chrome.runtime.sendMessage({\n        type: 'recording-complete',\n        target: 'background',\n        videoUrl: url,\n      })\n      callback?.(url)\n\n      this.recorder = undefined\n      this.data = []\n    }\n    this.recorder.onerror = (event) => {\n      console.error('MediaRecorder error:', event)\n    }\n    this.recorder.start()\n    this.startTime = Date.now()\n  }\n\n  public async stop() {\n    this.recorder?.stop()\n    this.recorder?.stream.getTracks().forEach((t) => t.stop())\n    this.media?.getTracks().forEach((t) => t.stop())\n    this.drawTimerId && clearTimeout(this.drawTimerId)\n  }\n}\n\nexport default Recorder\n"],"names":["name","definition","module","sections","doInherit","newClass","baseClass","WebmBase","type","source","data","WebmUint","padHex","hex","i","length","value","WebmFloat","byteArray","floatArrayType","floatArray","WebmContainer","firstByte","bytes","end","id","len","info","ctr","section","x","draft","flag","content","contentLength","WebmFile","duration","options","logger","message","segmentSection","infoSection","timeScaleSection","durationSection","mimeType","fixWebmDuration","blob","callback","resolve","reader","file","recorderMimeType","frameRate","bitRate","devicePixelRatio","Recorder","recordingMode","tabCaptureModes","area","canvas","ctx","video","drawFrame","streamId","width","height","audio","defaultRecordingMode","chromeMediaSource","videoConstraints","mediaStreamConstraints","audioContext","recorderMedia","audioTracks","event","fixedBlob","url","t"],"mappings":"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","x_google_ignoreList":[0]}